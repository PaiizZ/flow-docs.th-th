---
title: กรองและคัดลอกข้อมูล | Microsoft Docs
description: เรียนรู้วิธีการกรองและคัดลอกข้อมูลจากแหล่งข้อมูลไปยังปลายทางด้วย Microsoft Flow
services: ''
suite: flow
documentationcenter: na
author: MSFTMan
manager: anneta
editor: ''
tags: ''
ms.service: flow
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/21/2017
ms.author: deonhe
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: 702fd695a91fdf267f166d5162570b39505dbc91
ms.sourcegitcommit: a20fbed9941f0cd8b69dc579277a30da9c8bb31b
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 09/12/2018
ms.locfileid: "44690433"
---
# <a name="filter-and-copy-data-with-microsoft-flow"></a>กรองและคัดลอกข้อมูลด้วย Microsoft Flow
การฝึกปฏิบัตินี้แสดงวิธีการสร้างโฟลว์ที่ตรวจติดตามต้นทางสำหรับรายการใหม่หรือรายการที่เปลี่ยนแปลง จากนั้นคัดลอกการเปลี่ยนแปลงเหล่านั้นไปยังปลายทาง คุณสามารถสร้างโฟลว์เช่นนี้ได้ถ้าผู้ใช้ของคุณใส่ข้อมูลในตำแหน่งที่ตั้งเดียว แต่ทีมของคุณจำเป็นต้องใช้ข้อมูลในตำแหน่งที่ตั้งหรือรูปแบบอื่น

ขณะที่การฝึกปฏิบัตินี้คัดลอกข้อมูลจาก[รายการ](https://support.office.com/article/SharePoint-lists-I-An-introduction-f11cd5fe-bc87-4f9e-9bfe-bbd87a22a194) Microsoft SharePoint (ต้นทาง) ไปยังตาราง [ฐานข้อมูล Azure SQL](https://docs.microsoft.com/azure/sql-database/sql-database-technical-overview) (ปลายทาง) คุณสามารถคัดลอกข้อมูลใดก็ได้ในบรรดา [150 บริการ](https://flow.microsoft.com/connectors/)ที่ Microsoft Flow สนับสนุน

> [!IMPORTANT]
> การเปลี่ยนแปลงที่คุณดำเนินการในปลายทางไม่ได้ถูกคัดลอกไปยังต้นทาง เนื่องจากไม่สนับสนุนการซิงค์แบบสองทิศทาง ถ้าคุณพยายามทำการตั้งค่าการซิงค์แบบสองทิศทาง คุณจะต้องสร้างการวนรอบแบบไม่จำกัดที่จะมีการส่งการเปลี่ยนแปลงแบบไม่จำกัดระหว่างต้นทางและปลายทาง
> 
> 

## <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น
* เข้าถึงแหล่งข้อมูลและปลายทาง การฝึกปฏิบัตินี้ไม่รวมขั้นตอนในการสร้างต้นทางและปลายทาง
* เข้าใช้งาน [Microsoft Flow](https://flow.microsoft.com)
* ความเข้าใจพื้นฐานของวิธีจัดเก็บข้อมูลของคุณ
* ความคุ้นเคยกับข้อมูลพื้นฐานในการสร้างโฟลว์ คุณสามารถตรวจทานวิธีการเพิ่ม[การดำเนินการ, ทริกเกอร์](multi-step-logic-flow.md#add-another-action) และ[เงื่อนไข](add-condition.md)ได้ ขั้นตอนต่อไปนี้ถือว่าคุณทราบวิธีการดำเนินการเหล่านี้แล้ว

> [!TIP]
> ชื่อคอลัมน์ทั้งหมดในต้นทางและปลายทางไม่จำเป็นต้องตรงกัน แต่คุณต้องใส่ข้อมูลในทุกคอลัมน์ที่*จำเป็นต้องมี*เมื่อคุณแทรกหรืออัปเดตรายการ Microsoft Flow ระบุเขตข้อมูลที่จำเป็นสำหรับคุณ
> 
> 

## <a name="quick-overview-of-the-steps"></a>ภาพรวมด่วนของขั้นตอน
ถ้าคุณคุ้นเคยกับ Microsoft Flow ใช้ขั้นตอนรวดเร็วเหล่านี้เพื่อทำการคัดลอกข้อมูลจากแหล่งข้อมูลหนึ่งไปยังอีกแหล่งข้อมูล:

1. ระบุต้นทางที่คุณจะตรวจติดตาม และปลายทางที่คุณจะคัดลอกข้อมูลที่เปลี่ยนแปลง ยืนยันว่าคุณสามารถเข้าถึงได้ทั้งสองรายการ
2. ระบุอย่างน้อยหนึ่งคอลัมน์ที่ระบุเฉพาะรายการในต้นทางและปลายทาง ในตัวอย่างที่เกิดขึ้นหลังจากนั้น เราใช้คอลัมน์**ชื่อเรื่อง** แต่คุณสามารถใช้คอลัมน์ใดก็ได้ที่คุณต้องการ
3. ตั้งค่าทริกเกอร์ที่ตรวจติดตามต้นทางสำหรับการเปลี่ยนแปลง
4. ค้นหาปลายทางเพื่อให้ทราบว่ารายการที่เปลี่ยนแปลงนั้นมีอยู่หรือไม่
5. ใช้**เงื่อนไข**ดังนี้:
   * ถ้ารายการใหม่หรือรายการที่เปลี่ยนแปลงไม่มีอยู่ในปลายทาง สร้างรายการขึ้น
   * ถ้ารายการใหม่หรือรายการที่เปลี่ยนแปลงมีอยู่ในปลายทาง ให้อัปเดตรายการ
6. ทริกเกอร์โฟลว์ของคุณ และยืนยันว่ารายการใหม่หรือรายการที่เปลี่ยนแปลงจะถูกคัดลอกจากต้นทางไปยังปลายทาง

> [!NOTE]
> ถ้าคุณยังไม่ได้สร้างการเชื่อมต่อไปยัง SharePoint หรือฐานข้อมูล Azure SQL ก่อนหน้านี้ ทำตามคำแนะนำต่อไปนี้เมื่อคุณได้รับพร้อมท์ให้ลงชื่อเข้าใช้
> 
> 

ต่อไปนี้เป็นขั้นตอนโดยละเอียดในการสร้างโฟลว์

## <a name="monitor-the-source-for-changes"></a>ตรวจติดตามต้นทางสำหรับการเปลี่ยนแปลง
1. ลงชื่อเข้าใช้ [Microsoft Flow](https://flow.microsoft.com) เลือก**โฟลว์ของฉัน** > **สร้างจากเอกสารเปล่า**
2. ค้นหา**SharePoint** > เลือกทริกเกอร์ **SharePoint - เมื่อรายการถูกสร้างหรือปรับเปลี่ยน**จากรายการของทริกเกอร์
3. ใส่**ที่อยู่ไซต์** แล้วเลือก**ชื่อรายการ**บนบัตร**เมื่อรายการถูกสร้างหรือปรับเปลี่ยน**
   
    ใส่**ที่อยู่ไซต์**และ**ชื่อรายการ**สำหรับรายการ SharePoint ที่โฟลว์ของคุณตรวจติดตามรายการใหม่หรือรายการที่ปรับปรุง
   
    ![กำหนดค่าทริกเกอร์ Sharepoint](media/odata-filters/configure-sharepoint-trigger.png)

## <a name="search-the-destination-for-the-new-or-changed-item"></a>ค้นหาปลายทางสำหรับรายการใหม่หรือรายการที่เปลี่ยนแปลง
เราใช้การดำเนินการ **SQL Server - รับแถว**เพื่อค้นหาปลายทางสำหรับรายการใหม่หรือรายการที่เปลี่ยนแปลง

1. เลือก **ขั้นตอนใหม่** > **เพิ่มการดำเนินการ**
2. ค้นหา**รับแถว** เลือก**SQL Server - รับแถว** จากนั้นเลือกตารางที่คุณต้องการตรวจติดตามจากรายการ**ชื่อตาราง**
3. เลือก **แสดงตัวเลือกขั้นสูง**
4. ในกล่อง**คิวรีตัวกรอง** ใส่ **Title eq '** เลือกโทเค็น**ชื่อเรื่อง**จากรายการเนื้อหาแบบไดนามิกและใส่ **'**
   
    ขั้นตอนก่อนหน้านี้ถือว่าคุณกำลังจับคู่ชื่อเรื่องของแถวในต้นทางกับปลายทาง
   
    ตอนนี้บัตร**รับแถว**ควรมีลักษณะเหมือนรูปภาพนี้:
   
    ![พยายามให้ได้รายการจากฐานข้อมูลปลายทาง](media/odata-filters/configure-sql-get-rows-action.png)

## <a name="check-if-the-new-or-changed-item-was-found"></a>ตรวจสอบว่าพบรายการใหม่หรือรายการที่เปลี่ยนแปลงหรือไม่
เลือก**ขั้นตอนใหม่** >  **เพิ่มเงื่อนไข**เพื่อเปิดบัตร**เงื่อนไข**

ที่บัตรเงื่อนไข

1. เลือกกล่องทางด้านซ้าย
   
    รายการ**เพิ่มเนื้อหาแบบไดนามิกจากแอปและตัวเชื่อมต่อที่ใช้ในโฟลว์นี้**เปิดขึ้น
2. เลือก**ค่า**จากประเภท**รับแถว**
   
   > [!TIP]
   > ยืนยันว่าคุณได้ลือก**ค่า**จากประเภท**รับแถว** อย่าเลือก**ค่า**จากประเภท **เมื่อรายการถูกสร้างหรือปรับเปลี่ยน**
   > 
   > 
3. เลือก**เท่ากับ**จากรายการในกล่องศูนย์กลาง
4. ป้อน **0** (ศูนย์) ในกล่องทางด้านขวา
   
    ตอนนี้บัตร**เงื่อนไข**ของคุณจะคล้ายกับรูปภาพนี้:
   
    ![กำหนดค่าเงื่อนไข](media/odata-filters/configure-condition.png)
5. เลือก **แก้ไขในโหมดขั้นสูง**
   
    เมื่อโหมดขั้นสูงเปิดขึ้น คุณจะเห็นนิพจน์ **\@equals(body('Get_rows')?['value'], 0)** ในกล่องดังกล่าว แก้ไขนิพจน์นี้โดยการเพิ่มฟังก์ชัน **length()** around the **body('Get_items')?['value']** ตอนนี้ทั้งนิพจน์ปรากฏขึ้นดังนี้: **@equals(length(body('Get_rows')?['value']), 0)**
   
    ตอนนี้บัตร**เงื่อนไข**ของคุณจะคล้ายกับรูปภาพนี้:
   
    ![กำหนดค่าเงื่อนไข](media/odata-filters/configure-condition-add-length.png)
   
   > [!TIP]
   > การเพิ่มฟังก์ชัน**ความยาว()** ช่วยให้โฟลว์ทำการตรวจสอบรายการ**ค่า**และเพื่อให้ทราบว่าโฟลว์ประกอบด้วยรายการใดหรือไม่
   > 
   > 

เมื่อโฟลว์ของคุณ "รับ" รายการจากปลายทาง จะมีผลลัพธ์ที่เป็นไปได้สองผลลัพธ์

| ผลลัพธ์ | ขั้นตอนถัดไป |
| --- | --- |
| รายการที่มีอยู่ |[ปรับปรุงรายการ](odata-filters.md#update-the-item-in-the-destination) |
| รายการไม่มีอยู่ |[สร้างรายการใหม่](odata-filters.md#create-the-item-in-the-destination) |

> [!NOTE]
> รูปภาพของบัตร**แทรกแถว**และ**ปรับปรุงแถว**ที่แสดงถัดไปอาจแตกต่างจากของคุณเนื่องจากบัตรเหล่านี้แสดงชื่อของคอลัมน์ในตารางฐานข้อมูล SQL ของ Azure ที่ใช้ในโฟลว์
> 
> 

## <a name="create-the-item-in-the-destination"></a>สร้างรายการดังกล่าวในปลายทาง
ถ้ารายการไม่มีอยู่ในปลายทาง ให้สร้างโดยใช้การดำเนินการ **SQL Server - แทรกแถว**

บนสาขา**ถ้าใช่**ของ**เงื่อนไข**:

1. เลือก**เพิ่มการดำเนินการ** ค้นหา**แทรกแถว** แล้วเลือก**SQL Server - แทรกแถว**
   
    บัตร**แทรกแถว**จะเปิดขึ้น
2. จากรายการ**ชื่อตาราง** เลือกตารางที่จะแทรกรายการใหม่เข้าไป
   
    บัตร**แทรกแถว**ขยายและแสดงเขตข้อมูลทั้งหมดในตารางที่เลือก จำเป็นต้องมีเขตข้อมูลที่มีเครื่องหมายดอกจัน (*) และต้องปรากฏอยู่เพื่อให้แถวถูกต้อง
3. เลือกแต่ละเขตข้อมูลที่คุณต้องการให้ปรากฏอยู่ และใส่ข้อมูล
   
    คุณอาจใส่ข้อมูลด้วยตนเอง เลือกอย่าง น้อยหนึ่งโทเค็นจาก**เนื้อหาแบบไดนามิก** หรือป้อนชุดของข้อความและโทเค็นใด ๆ ลงในเขตข้อมูลดังกล่าวได้
   
    ตอนนี้บัตร**แทรกแถว**ของคุณจะคล้ายกับรูปภาพนี้:
   
    ![กำหนดค่าเงื่อนไข](media/odata-filters/insert-row.png)

## <a name="update-the-item-in-the-destination"></a>ปรับปรุงรายการดังกล่าวในปลายทาง
ถ้ารายการมีอยู่ในปลายทาง ปรับปรุงรายการด้วยการเปลี่ยนแปลง

1. เพิ่มการดำเนินการ **SQL Server - ปรับปรุงแถว**ไปยังสาขา**ถ้าไม่ใช่**ของ**เงื่อนไข**
2. ทำตามขั้นตอนในส่วน[สร้างรายการ](odata-filters.md#create-the-item-in-the-destination)ของเอกสารนี้เพื่อแสดงเขตข้อมูลของตาราง
   
    ![ดูสิ่งแวดล้อม](media/odata-filters/update-row.png)
3. ที่ด้านบนของหน้า ใส่ชื่อสำหรับโฟลว์ของคุณในกล่อง**ชื่อโฟลว์** จากนั้น**สร้างโฟลว์**เพื่อบันทึก
   
    ![ตั้งชื่อโฟลว์ของคุณ](media/odata-filters/give-the-flow-a-name.png)

ตอนนี้ เมื่อใดก็ตามที่รายการในรายการ SharePoint (แหล่งข้อมูล) ของคุณเปลี่ยนแปลง โฟลว์ของคุณจะทริกเกอร์และแทรกรายการใหม่หรือปรับปรุงรายการที่มีอยู่ในฐานข้อมูล SQL ของ Azure (ปลายทาง) ของคุณ

> [!NOTE]
> โฟลว์ของคุณจะไม่ถูกทริกเกอร์เมื่อมีการลบรายการหนึ่งจากแหล่งข้อมูล หากนี่เป็นสถานการณ์ที่สำคัญ ให้พิจารณาเพิ่มอีกคอลัมน์ที่บ่งชี้เมื่อรายการไม่จำเป็นต้องใช้อีกต่อไป
> 
> 

## <a name="learn-more"></a>เรียนรู้เพิ่มเติม
ใช้[การดำเนินการข้อมูล](data-operations.md)ในโฟลว์ของคุณ

